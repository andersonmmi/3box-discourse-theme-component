<script type="text/discourse-plugin" version="0.8">
    console.log("Maker Badge Theme Component Running");
</script>

<script type="text/x-handlebars" data-template-name="/connectors/user-preferences-account/maker-badges">
    <div class='control-label'>
        Claim MakerDAO Badges
    </div>
    {{mount-widget widget="maker-badges-loader-widget"}}
</script>

<script Xtype="text/discourse-plugin" version="0.8">
console.log("Discourse:", Discourse);

// const h require("virtual-dom").h;

api.createWidget('maker-badges-loader-widget', {
    tagName: "button.maker-badges",
    html() {
        return "Import Maker Badges";
    },
    click(e) {
        e.preventDefault();
        console.log("Maker badge loader button got clicked");

        const username = Discourse.currentUser.username;
        console.log("Username", username);

        // window.ethereum.enable();  // Deprecated

        try {
            ethereum.send('eth_requestAccounts').then((accounts) => {
                console.log("Ethereum Accounts", accounts);
            });
        } catch (error) {
            console.log("User denied Ethereum account access");
        }

        //.then((accounts) => {
        //    console.log("Connected to Ethereum client");
        //}

    }
});
</script>

